%
%
\chapter{Download und Installation des MyCoRe Kerns}
%
%
\section{Download des MyCoRe Kerns}
%
%
Der MyCoRe Kern wird f"ur alle unterst"utzten Systeme "uber das CVS Repository
ausgeliefert. Das Holen der aktuellen Version erfolgt mit dem Kommando
\begin{center}
{\tt cvs -d :pserver:anoncvs@server.mycore.de:/cvs checkout mycore}
\end{center}
Nach dem erfolgreichen Checkout erhalten Sie folgende Dateistruktur:\\[2ex]
\bottomcaption{Dateistruktur des MyCoRe Kernes}
\tablehead{\hline}
\tabletail{\hline}
\begin{supertabular}{|p{5cm}|p{10cm}|}
\hline
{\bf mycore} &  Das Root-Verzeichnis des MyCoRe-Kerns \\
\quad {\bf bin} & Das Verzeichnis der Shellscripte \\
\qquad build.sh & Startet den Build-Prozess unter einem UNIX-System \\
\qquad build.cmd & Startet den Build-Prozess unter einem Windows-System \\
\qquad build.properties & Konfiguration Pfade und Libraries der verwendeten Datenbanken \\ 
\quad {\bf documentation} & Dokumentationen zu MyCoRe \\
\quad {\bf lib} & Notwendige zus"atzliche Java-Bibliotheken \\
\quad {\bf schema} & XMLSchema Dateien, die anwendungsunabh"angig sind \\
\quad {\bf stylesheets} & Intern verwendete, anwendungsunabh"angige XSL Stylesheets \\
\quad {\bf sources/org/mycore} & Die Wurzel des MyCoRe-Source-Baumes \\
\qquad {\bf datamodel} & Klassen zum Datenmodell \\
\quad \qquad {\bf classifications} & Klassen zur Arbeit mit den Klassifikationen \\
\quad \qquad {\bf ifs} & Klassen zur Arbeit mit dem Internal File System \\
\quad \qquad {\bf metadata} & Klassen zur Arbeit mit den Metdaten \\
\qquad {\bf common} & Klassen, die im gesamten Projekt benötigt werden \\
\quad \qquad {\bf xml} & Allgemeine Klassen zur XML Verarbeitung \\
\qquad {\bf backend} & Klassen f"ur die verschiedenen Data Stores \\
\quad \qquad {\bf cm7} & Klassen zur Nutzung des IBM Content Manager 7 \footnote{Die Klassen für den IBM Content Manager 7 werden nicht mehr weiterentwickelt!} \\
\quad \qquad {\bf cm8} & Klassen zur Nutzung des IBM Content Manager 8.2 \\
\quad \qquad {\bf filesystem} & Klassen zum Content Store im lokalen Filesystem \\
\quad \qquad {\bf realhelix} & Klassen zum Content Store in einem Helix-Server \\
\quad \qquad {\bf remote} & Klassen zum Zugriff auf Remote-MyCoRe-Daten \\
\quad \qquad {\bf sql} & Klassen zum Zugriff auf relationale Datenbanken mittels SQL-Standart \\
\quad \qquad {\bf videocharger} & Klassen zum Content Store in einen IBM Videocharger \\
\quad \qquad {\bf xmldb} & Klassen zur Speicherung der Daten mittels einer XML:DB \\
\qquad {\bf frontend} & Klassen f"ur die Frontends des MyCoRe-Systems \\
\quad \qquad {\bf cli} & Klassen des Commandline-Tools \\
\quad \qquad {\bf editor2} & Klassen zur Gestaltung von Editoren \\
\quad \qquad {\bf servlets} & Klassen zu Gestaltung von Servlets \\
\qquad {\bf services} & Klassen f"ur weiterf"uhrende Services des MyCoRe-Projektes \\
\quad \qquad {\bf nbn} & Klassen zur Arbeit mit NBN's \\
\quad \qquad {\bf oai} & Klassen zur Arbeit mit OAI Komponenten \\
\quad \qquad {\bf query} & Klassen zur Arbeit mit dem MyCoRe internen Query-System \\
\qquad {\bf user} & Klassen des User- und Rechteverwaltungssystems \\
\quad build.xml & Ant Build-Datei, steuert den MyCoRe Build-Prozess \\
\quad license.txt & Das Lizenz-File des MyCoRe-Projektes, bitte lesen Sie dieses File aufmerksam durch, bevor Sie MyCore einsetzen. \\
\hline
\end{supertabular}
%
%
\section{Konfiguration und "Ubersetzten des Kerns}
%
\begin{enumerate}
\item
MyCoRe verwendet das Apache Ant Build-Tool, um den Quellcode zu übersetzen und eine vollständige 
Beispiel-Applikation zu erzeugen. Entsprechend der Installationsanleitung des Ant-Paketes sollten Sie zunächst die
Umgebungsvariable {\tt JAVA\_HOME} und {\tt ANT\_HOME} gesetzt haben. Sollten diese Variablen auf Ihrem System noch nicht
gesetzt sein, können Sie dies in der Datei {\tt build.sh} (Unix) bzw. {\tt build.cmd} (Windows) nachholen und korrigieren.

\item
Es ist nicht nötig, weitere Umgebungsvariablen wie etwa den Java CLASSPATH zu setzen. Das MyCoRe Ant Build-Skript 
ignoriert den lokal gesetzten {\tt CLASSPATH} völlig und generiert stattdessen einen eigenen {\tt CLASSPATH} entsprechend Ihrer Konfiguration. 
Somit können wir sicherstellen, dass nur die erforderlichen Pakete und Klassen in der richtigen Version verwendet werden. Die Konfiguration der 
Systemumgebung der verwendeten Datenbanken für die XML-Speicherung (IBM CM7, IBM CM8, Apache Xindice, eXist) und die Speicherung von Tabellen
über JDBC in einer relationalen Datenbank (IBM DB2, MySQL, optional auch andere) wird in der Datei {\tt bin/build.properties}
festgelegt. 

\item
In der Regel werden Sie nur die beiden entsprechenden Blöcke für die verwendete XML-Datenbank ({\tt MCR.XMLStore.*}) und die
verwendete relationale Datenbank ({\tt MCR.JDBCStore.*}) durch kommentieren bzw. auskommentieren der vorgegebenen Zeilen und 
Anpassen der beiden Variablen {\tt MCR.XMLStore.BaseDir} und \\
{\tt MCR.JDBCStore.BaseDir} an die lokalen Installationsverzeichnisse
Ihrer Datenbanksysteme anpassen müssen. Die weiteren Variablen steuern die für den Betrieb notwendigen JAR-Dateien 
({\tt MCR.*Store.Jars}), eventuell zusätzlich in den CLASSPATH einzubindende class-Dateien oder Ressourcen ({\tt MCR.*Store.ClassesDirs})
und zur Laufzeit erforderliche native Libraries bzw. DLLs ({\tt MCR.*Store.LibPath}). Passen Sie die Werte entsprechend der
Dokumentation Ihres Datenbankproduktes und der Kommentare in der Datei selbst an.

\item
Sie sollten zunächst prüfen, ob ihre Systemumgebung korrekt eingerichtet ist, indem Sie 
\begin{center}
{\tt build.sh info } \qquad bzw. \qquad {\tt build.cmd info }
\end{center}
ausführen. Das Ant Build Tool zeigt Ihnen daraufhin die verwendeten JDK- und Ant-Software-Versionen und den
generierten CLASSPATH und LIBPATH (für Unix Systeme) an.

\item Sollten Sie festgestellt haben, dass Ihr JDK ab 1.4.x eine andere
Xalan-Version benutzt, führen Sie bitte folgende Kommandos aus und prüfen Sie danach Ihr System erneut.

{\tt
cd \$JAVA\_HOME/jre/lib \newline
mkdir endorsed \newline
cd endorsed \newline
cp \$MYCORE\_HOME/lib/xerces* . \newline
cp \$MYCORE\_HOME/lib/xalan* . \newline
cd \$JAVA\_HOME/lib \newline
ln -s ../jre/lib/endorsed endorsed
}

\item 
Eine Übersicht über alle wesentlichen Build-Ziele erhalten Sie mit
\begin{center}
{\tt build.sh usage } \qquad bzw. \qquad {\tt build.cmd usage } 
\end{center}

\item
Übersetzen Sie alle MyCoRe Quellcode-Dateien mit dem Befehl
\begin{center}
{\tt build.sh jar } \qquad bzw. \qquad {\tt build.cmd jar }
\end{center}
Dabei entsteht, abhängig von dem von Ihnen gewählten Datenbank-System zur Speicherung der XML-Daten eine Jar-Datei 
{\tt lib/mycore-for-[cm7|cm8|xmldb].jar}.

\item
Optional können Sie auch JavaDoc Quellcode-Dokumentation im HTML-Format generieren lassen, indem Sie
\begin{center}
{\tt build.sh javadocs } \qquad bzw. \qquad {\tt build.cmd javadocs }
\end{center}
aufrufen. Dabei entstehen HTML-Dateien im Verzeichnis {\tt documentation/html}.

\end{enumerate} 
%
%
