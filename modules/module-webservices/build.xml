<?xml version="1.0" encoding="ISO-8859-1"?>

<!-- ============================================== -->
<!--      MyCoRe-WebService build file for use with ANT        -->
<!-- $Revision: 1.1 $ $Date: 2005-12-14 14:18:24 $ -->
<!-- ============================================== -->

<project name="MyCoReModule - WebService" default="usage" basedir=".">

    <property name="hostname"      value="localhost" />
    <property name="port"          value="8080" />
    <property name="servletpath"   value="/docportal/services/AdminService" />

	<!-- ============================================== -->

	<property name="build.sysclasspath" value="last" />

	<!-- ============================================== -->

	<target name="version">
		<echo>
           Ant version: ${ant.version}
      Java JDK version: ${java.version} 
      Operating system: ${os.name}, version: ${os.version}, architecture: ${os.arch}
    </echo>
	</target>

	<!-- ============================================== -->

	<target name="usage">
		<echo>
      Use the ant tool to plug in MyCoRe-WeService-Module:
      Usage: ant [target] [target] [target] ...

      Available targets for MyCoRe-WebService are:
        compile                         compiles the Java Sources
        webapps                         copy files to webapps
        deploy                          deploy webservices
        undeploy                        undeploy webservices
		</echo>
	</target>
	
  <!-- =================================================================== -->
  <!-- Compiles the sources from directory sources to directory classes    -->
  <!-- =================================================================== -->

  <target name="init">
    <mkdir dir="${basedir}/classes" />
    <path id="mycore.classpath">
      <fileset dir="${basedir}/lib" includes="*.jar"/>
    </path>
  </target>

  <target name="javac" depends="init" >
    <echo>Compiling ${packages}</echo>
    <javac srcdir="${basedir}/modules/module-webservices/sources"
           destdir="${basedir}/classes"
           includes="${packages}"
           classpathref="mycore.classpath"
           debug="${debug}"
           optimize="${optimize}"
           target="${javatarget}"
           source="${sourcerelease}"
           encoding="${sourceencoding}"
           deprecation="${deprecation}">
    </javac>
  </target>

  <target name="compile">
   <echo>Compiling Module MyCoRe-WebServices classes...</echo>
   <antcall target="javac">
     <param name="packages" value="org/**"/>
   </antcall>
  </target>

  <!-- =================================================================== -->
  <target name="webapps">
    <echo>
      Copying web application files of module "WebServices"
    </echo>
    <copy todir="webapps/WEB-INF/lib">
      <fileset dir="${env.MYCORE_HOME}/modules/module-webservices/lib" includes="*.jar" />
    </copy>
  </target>

  <!-- ============================================== -->

  <!-- ============================================== -->

  <target name="deploy" description="deploys all webservices to a running axis admin servlet">
    <antcall target="axis.admin">
      <param name="wsdd" value="deploy" />
    </antcall>
  </target>

  <!-- ============================================== -->
	
  <target name="undeploy" description="undeploys all webservices from a running axis admin servlet">
    <antcall target="axis.admin">
      <param name="wsdd" value="undeploy" />
    </antcall>
  </target>

  <!-- ============================================== -->
		
  <target name="axis.admin">
    <path id="deploy.classpath">
      <fileset dir="../../lib" includes="*.jar" />
      <fileset dir="lib" includes="*.jar" />
    </path>
    <taskdef resource="axis-tasks.properties" classpathref="deploy.classpath" />
    <axis-admin 
      port="${port}" 
      hostname="${hostname}" 
      failonerror="true" 
      servletpath="${servletpath}" 
      debug="true" 
      xmlfile="conf/${wsdd}.wsdd" 
    />
  </target>

</project>


