<!-- build.xml - build file for the MyCoRe API -->

<project default="usage" basedir=".">

  <!-- =================================================================== -->
  <!-- Constant values                                                     -->
  <!-- =================================================================== -->

  <!-- general -->
  <property name="Name" value="MyCoRe"/>
  <property name="name" value="mycore"/>
  <property name="version" value="1.0"/>

  <!-- compiler -->
  <property name="build.compiler" value="classic"/>
  <property name="debug" value="on"/>
  <property name="optimize" value="on"/>
  <property name="deprecation" value="on"/>
    
  <!-- file system -->
  <property name="mycore.source" value="./sources"/>
  <property name="mycore.source.common" value="./sources/mycore/common"/>
  <property name="mycore.source.xml" value="./sources/mycore/xml"/>
  <property name="mycore.source.datamodel" value="./sources/mycore/datamodel"/>
  <property name="mycore.source.classifications" value="./sources/mycore/classifications"/>
  <property name="mycore.source.ifs" value="./sources/mycore/ifs"/>
  <property name="mycore.source.communication" value="./sources/mycore/communication"/>
  <property name="mycore.source.cm7" value="./sources/mycore/cm7"/>
  <property name="mycore.source.cm8" value="./sources/mycore/cm8"/>
  <property name="mycore.source.sql" value="./sources/mycore/sql"/>
  <property name="mycore.source.user" value="./sources/mycore/user"/>
  <property name="mycore.source.command" value="./sources/mycore/commandline"/>
  <property name="mycore.source.nbn" value="./sources/mycore/nbn"/>
  <property name="mycore.class" value="./classes"/>
  <property name="mycore.javadoc" value="./javadocs"/>
  <property name="mycore.lib" value="./lib"/>
    
  <!-- =================================================================== -->
  <!-- Help on usage                                                       -->
  <!-- =================================================================== -->
  <target name="usage">
    <echo message=""/>
    <echo message="----------- ${Name} ${version} ------------"/>
    <echo message=""/>
    <echo message="${Name} build file"/>
    <echo message="-------------------------------------------------------------"/>
    <echo message=""/>
    <echo message=" available targets are:"/>
    <echo message=""/>
    <echo message="   package  --> generates the classes and javadocs"/>
    <echo message="   compile  --> compiles the source code"/>
    <echo message="   javadocs --> generates the JavaDoc API documentation"/>
    <echo message="   jar      --> creates a jar file containing all MyCoRe classes"/>
    <echo message="   clean    --> cleans up the directory, removes all generated files"/>
    <echo message=""/>
    <echo message=" See the comments inside the build.xml file for more details."/>
    <echo message="-------------------------------------------------------------"/>
    <echo message=""/>
    <echo message=""/>
  </target>

  <!-- =================================================================== -->
  <!-- The initalization for all                                           -->
  <!-- =================================================================== -->
  <target name="init" >
   <mkdir dir="${mycore.class}"/>
   <mkdir dir="${mycore.javadoc}"/>
   <mkdir dir="${mycore.lib}"/>
  </target>
  
  <!-- =================================================================== -->
  <!-- Creates the class package                                           -->
  <!-- =================================================================== -->
  <target name="package" depends="compile,javadocs">
  </target>

  <!-- =================================================================== -->
  <!-- Creates a mycore.jar file containing all compiled MyCoRe classes    -->
  <!-- =================================================================== -->
  <target name="jar" depends="compile">
    <jar jarfile="${mycore.lib}/mycore.jar" basedir="${mycore.class}"/>
  </target>
  
  <!-- =================================================================== -->
  <!-- Compiles all source directory                                       -->
  <!-- =================================================================== -->
  <target name="compile" depends="init,compile_common,compile_xml,compile_datamodel,compile_sql,compile_cm7,compile_classifications,compile_ifs,compile_user,compile_communication,compile_commandline">
  </target>
  
  <target name="compile_common">
    <!-- compiles the common source classes -->
    <javac srcdir="${mycore.source.common}"
           destdir="${mycore.class}"
           debug="${debug}"
           optimize="${optimize}">
    </javac>
  </target>

  <target name="compile_cm7">
    <!-- compiles the Content Manager 7 source classes -->
    <javac srcdir="${mycore.source.cm7}"
           destdir="${mycore.class}"
           debug="${debug}"
           optimize="${optimize}">
    </javac>
  </target>

  <target name="compile_cm8">
    <!-- compiles the Content Manager 8 source classes -->
    <javac srcdir="${mycore.source.cm8}"
           destdir="${mycore.class}"
           debug="${debug}"
           optimize="${optimize}">
    </javac>
  </target>

  <target name="compile_sql">
    <!-- compiles the JDBC SQL source classes -->
    <javac srcdir="${mycore.source.sql}"
           destdir="${mycore.class}"
           debug="${debug}"
           optimize="${optimize}">
    </javac>
  </target>

  <target name="compile_classifications">
    <!-- compiles the classifications source classes -->
    <javac srcdir="${mycore.source.classifications}"
           destdir="${mycore.class}"
           debug="${debug}"
           optimize="${optimize}">
    </javac>
  </target>

  <target name="compile_ifs">
    <!-- compiles the source classes for the internal filesystem IFS -->
    <javac srcdir="${mycore.source.ifs}"
           destdir="${mycore.class}"
           debug="${debug}"
           optimize="${optimize}">
    </javac>
  </target>

  <target name="compile_communication">
    <!-- compiles the communication source classes -->
    <javac srcdir="${mycore.source.communication}"
           destdir="${mycore.class}"
           debug="${debug}"
           optimize="${optimize}">
    </javac>
  </target>

  <target name="compile_xml">
    <!-- compiles the xml source classes -->
    <javac srcdir="${mycore.source.xml}"
           destdir="${mycore.class}"
           debug="${debug}"
           optimize="${optimize}">
    </javac>
  </target>

  <target name="compile_datamodel">
    <!-- compiles the datamodel source classes -->
    <javac srcdir="${mycore.source.datamodel}"
           destdir="${mycore.class}"
           debug="${debug}"
           optimize="${optimize}">
    </javac>
  </target>

  <target name="compile_user">
    <!-- compiles the user management source classes -->
    <javac srcdir="${mycore.source.user}"
           destdir="${mycore.class}"
           debug="${debug}"
           optimize="${optimize}">
    </javac>
  </target>

  <target name="compile_commandline">
    <!-- compiles the commandline tool source classes -->
    <javac srcdir="${mycore.source.command}"
           destdir="${mycore.class}"
           debug="${debug}"
           optimize="${optimize}">
    </javac>
  </target>

  <target name="compile_nbn">
    <!-- compiles the National Bibliographic Names source classes -->
    <javac srcdir="${mycore.source.nbn}"
           destdir="${mycore.class}"
           debug="${debug}"
           optimize="${optimize}">
    </javac>
  </target>

  <!-- =================================================================== -->
  <!-- Create the JavaDocs from sources                                    -->
  <!-- =================================================================== -->
  <target name="javadocs" depends="init">
    <echo>

      Building the MyCoRe source code JavaDoc documentation...

      NOTE: Under AIX, you have to do the following to make this work:
      ln -s /usr/java_dev2/lib/tools.jar /usr/java_dev2/jre/lib/ext/tools.jar
    </echo>
    <javadoc
      packagenames = "mycore.*"
      sourcepath   = "${mycore.source}"
      destdir      = "${mycore.javadoc}"
      author       = "true"
      version      = "true"
      use          = "true"
      access       = "package"
      splitindex   = "true"
      windowtitle  = "MyCoRe JavaDoc Documentation"
      doctitle     = "MyCoRe Source Code JavaDoc Documentation"
    >
      <group title="MyCoRe Packages" packages="mycore.*"/>
      <link href="http://www.mycore.de/library/jdk1.2.2/docs/api"/>
      <link href="http://www-3.ibm.com/software/data/eip/pubs/v7/frnjapr/java"/>
      <link href="http://www.mycore.de/tomcat/documentation/docs/api"/>
      <link href="http://www.mycore.de/library/jaxp/docs/api"/>
      <link href="http://www.jdom.org/docs/apidocs"/>
    </javadoc>
  </target>

  <!-- =================================================================== -->
  <!-- Remove the user created directories and files                       -->
  <!-- =================================================================== -->
  <target name="clean" depends="init">
    <delete includeEmptyDirs="true" >
      <fileset dir="${mycore.javadoc}" />
      <fileset dir="${mycore.class}" />
      <fileset dir="${mycore.lib}" />
    </delete>
  </target>

</project>

<!-- End of file -->

